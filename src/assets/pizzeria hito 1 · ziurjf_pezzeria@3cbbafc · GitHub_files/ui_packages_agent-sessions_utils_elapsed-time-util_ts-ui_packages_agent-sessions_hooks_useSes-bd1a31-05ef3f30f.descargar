"use strict";(globalThis.webpackChunk=globalThis.webpackChunk||[]).push([["ui_packages_agent-sessions_utils_elapsed-time-util_ts-ui_packages_agent-sessions_hooks_useSes-bd1a31"],{1574:(e,t,r)=>{r.d(t,{Y:()=>n,w:()=>o});let n={InProgress:"in_progress",Completed:"completed",Failed:"failed",Idle:"idle",WaitingForUser:"waiting_for_user",TimedOut:"timed_out",Cancelled:"cancelled"};function o(e){switch(e){case n.InProgress:return"In progress";case n.Completed:return"Completed";case n.Failed:return"Failed";case n.Idle:return"Idle";case n.WaitingForUser:return"Waiting for User";case n.TimedOut:return"Timed out";case n.Cancelled:return"Cancelled";default:return"Unknown"}}},99723:(e,t,r)=>{r.d(t,{Y:()=>n});function n(e,t){let r=new Date(e).getTime(),n=Math.floor(((t&&"0001-01-01T00:00:00Z"!==t?new Date(t).getTime():Date.now())-r)/1e3),o=[{value:Math.floor(n/86400),label:"d"},{value:Math.floor(n%86400/3600),label:"h"},{value:Math.floor(n%3600/60),label:"m"},{value:n%60,label:"s"}].filter(e=>e.value>0);return 0===o.length?"0s":1===o.length?`${o[0]?.value??0}${o[0]?.label??""}`:o[1]?`${o[0]?.value}${o[0]?.label} ${o[1].value}${o[1].label??""}`:`${o[0]?.value??0}${o[0]?.label??""}`}},53005:(e,t,r)=>{r.d(t,{O:()=>a,S:()=>i});var n=r(96679);let o=n.cg?.document?.head?.querySelector('meta[name="release"]')?.content||"",i="X-GitHub-Client-Version";function a(){return o}},54187:(e,t,r)=>{r.d(t,{l:()=>AgentSessionsTokenProvider});var n=r(879);let AgentSessionsTokenProvider=class AgentSessionsTokenProvider extends n.J{constructor(e,t){super([],`/${e.ownerLogin}/${e.name}/pull/${t}/agent-sessions/token`,"AGENT_SESSIONS_TOKEN")}}},92520:(e,t,r)=>{function n(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}r.d(t,{Y:()=>AuthToken});let AuthToken=class AuthToken{get authorizationHeaderValue(){return`GitHub-Bearer ${this.value}`}needsRefreshing(e){return this.isExpired||this.ssoChanged(e)}get isExpired(){let e=new Date(this.expiration);return new Date(Date.UTC(e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate(),e.getUTCHours(),e.getUTCMinutes(),e.getUTCSeconds(),e.getUTCMilliseconds()))<new Date(Date.now()+15e3)}ssoChanged(e){return!(this.ssoOrgIDs.every(t=>e.includes(t))&&e.every(e=>this.ssoOrgIDs.includes(e)))}static fromResult(e,t){return new AuthToken(e.token,e.expiration,t)}serialize(){return{value:this.value,expiration:this.expiration,ssoOrgIDs:this.ssoOrgIDs}}static deserialize(e){return new AuthToken(e.value,e.expiration,e.ssoOrgIDs)}constructor(e,t,r){n(this,"value",void 0),n(this,"expiration",void 0),n(this,"ssoOrgIDs",void 0),this.value=e,this.expiration=t,this.ssoOrgIDs=r}}},879:(e,t,r)=>{r.d(t,{J:()=>CopilotAuthTokenProvider});var n=r(92520),o=r(85351),i=r(60039);function a(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}let CopilotAuthTokenProvider=class CopilotAuthTokenProvider{async getAuthToken(){let e=this.getLocalStorageAuthToken();return e?this.validateAuthToken(e):this.fetchAuthToken()}setLocalStorageAuthToken(e){this.copilotLocalStorage.setItem(this.storageKey,JSON.stringify(e.serialize()))}getLocalStorageAuthToken(){let e=this.copilotLocalStorage.getItem(this.storageKey);return e?n.Y.deserialize(JSON.parse(e)):null}async getTokenForSpark(){let e=await this.getAuthToken(),t=new Date(e.expiration);return new Date(Date.UTC(t.getUTCFullYear(),t.getUTCMonth(),t.getUTCDate(),t.getUTCHours(),t.getUTCMinutes(),t.getUTCSeconds(),t.getUTCMilliseconds()))<new Date(Date.now()+42e4)?this.fetchAuthToken():e}async validateAuthToken(e){return e.needsRefreshing(this.ssoOrgIDs)?this.fetchAuthToken():e}fetchAuthToken(){return this.currentAuthTokenRequest||(this.currentAuthTokenRequest=this._fetchAuthToken()),this.currentAuthTokenRequest}async _fetchAuthToken(){let e=await (0,i.lS)(this.tokenEndpoint,{method:"POST"});if(e.ok){let t=await e.json();this.currentAuthTokenRequest=null;let r=n.Y.fromResult(t,this.ssoOrgIDs);return this.setLocalStorageAuthToken(r),r}throw this.currentAuthTokenRequest=null,Error("Failed to mint new auth token")}constructor(e,t="/github-copilot/chat/token",r="COPILOT_AUTH_TOKEN"){a(this,"tokenEndpoint",void 0),a(this,"storageKey",void 0),a(this,"ssoOrgIDs",void 0),a(this,"currentAuthTokenRequest",void 0),a(this,"copilotLocalStorage",void 0),this.ssoOrgIDs=e,this.currentAuthTokenRequest=null,this.copilotLocalStorage=(0,o.A)("localStorage",{throwQuotaErrorsOnSet:!1,ttl:864e5}),this.storageKey=r,this.tokenEndpoint=t}}},26559:(e,t,r)=>{r.d(t,{jC:()=>u,kt:()=>a,tV:()=>s});var n=r(53005),o=r(27851),i=r(88191);function a(e){let t={"X-Requested-With":"XMLHttpRequest",...(0,i.wE)(e)};return(0,o.G7)("client_version_header")&&(t={...t,[n.S]:(0,n.O)()}),t}function s(e,t){for(let[r,n]of Object.entries(a(t)))e.set(r,n)}function u(e){return{"X-GitHub-App-Type":e}}},88191:(e,t,r)=>{r.d(t,{$r:()=>a,M1:()=>s,li:()=>o,pS:()=>l,wE:()=>u});var n=r(96679);let o="X-Fetch-Nonce",i=new Set;function a(e){i.add(e)}function s(){return i.values().next().value||""}function u(e){let t={};return void 0!==e&&(t["X-Fetch-Nonce-To-Validate"]=e),void 0===e?t[o]=s():i.has(e)?t[o]=e:t[o]=Array.from(i).join(","),t}function l(){let e=n.XC?.head?.querySelector('meta[name="fetch-nonce"]')?.content||"";e&&a(e)}},60039:(e,t,r)=>{r.d(t,{DI:()=>o,QJ:()=>a,Sr:()=>s,lS:()=>i});var n=r(26559);function o(e,t={}){var r=e;if(new URL(r,window.location.origin).origin!==window.location.origin)throw Error("Can not make cross-origin requests from verifiedFetch");let i=function(e){let t=new URL(e,window.location.href),r=new URL(window.location.href,window.location.origin),n=r.searchParams.get("_features");n&&!t.searchParams.has("_features")&&t.searchParams.set("_features",n);let o=r.searchParams.get("_tracing");return o&&!t.searchParams.has("_tracing")&&t.searchParams.set("_tracing",o),e.startsWith(window.location.origin)?t.href:`${t.pathname}${t.search}`}(e),a={...t.headers,"GitHub-Verified-Fetch":"true",...(0,n.kt)()};return fetch(i,{...t,headers:a})}function i(e,t){let r={...t?.headers??{},Accept:"application/json","Content-Type":"application/json"},n=t?.body?JSON.stringify(t.body):void 0;return o(e,{...t,body:n,headers:r})}function a(e,t={}){let r={...t.headers,"GitHub-Is-React":"true"};return o(e,{...t,headers:r})}function s(e,t){let r={...t?.headers??{},"GitHub-Is-React":"true"};return i(e,{...t,headers:r})}},47360:(e,t,r)=>{r.d(t,{mE:()=>u,mV:()=>s});var n=r(74848),o=r(21728),i=r(96540);let a=(0,i.createContext)(void 0);function s(){let e=(0,i.useContext)(a);if(!e)throw Error("usePullContext must be used within a PullContextProvider");return e}function u(e){let t,r,i,s=(0,o.c)(5),{pull:u,children:l}=e;return s[0]!==u?(r={pull:u},s[0]=u,s[1]=r):r=s[1],t=r,s[2]!==l||s[3]!==t?(i=(0,n.jsx)(a.Provider,{value:t,children:l}),s[2]=l,s[3]=t,s[4]=i):i=s[4],i}try{a.displayName||(a.displayName="PullContext")}catch{}try{u.displayName||(u.displayName="PullContextProvider")}catch{}},20235:(e,t,r)=>{r.d(t,{t:()=>c});var n=r(21728),o=r(97286),i=r(1574),a=r(54187);let s=JSON.parse('{"M":[{"id":"6eab781c-49c1-41e1-ab63-ef7872033702","name":"","user_id":10053402,"agent_id":1143301,"state":"completed","logs":"","owner_id":9919,"repo_id":956201709,"resource_type":"pull","resource_id":"26","last_updated_at":"2025-04-03T15:28:12.164448308Z","created_at":"2025-04-03T15:22:56.301948291Z","completed_at":"2025-04-03T15:32:56.301948291Z","premium_requests":2},{"id":"4dfb781c-49c1-41e1-ab63-ef7872033702","name":"review by @actor","user_id":10053402,"agent_id":1143301,"state":"in_progress","logs":"","owner_id":9919,"repo_id":956201709,"resource_type":"pull","resource_id":"26","last_updated_at":"2025-04-03T15:28:12.164448308Z","created_at":"2025-04-09T21:22:56.301948291Z","completed_at":null,"premium_requests":0}]}');var u=r(88795),l=r(47360);function c(e){let t,r,i,c,d,g=(0,n.c)(21),{initialData:p,useMockData:f,sessionsPollingInterval:T}=e,m=(0,u.t)(),{pull:v}=(0,l.mV)(),{id:w,number:k}=v;g[0]!==k||g[1]!==m||g[2]!==f?(t=f?null:new a.l(m,k),g[0]=k,g[1]=m,g[2]=f,g[3]=t):t=g[3];let _=t;return g[4]!==w||g[5]!==m.name||g[6]!==m.ownerLogin||g[7]!==f?(r=["agent-sessions",m.ownerLogin,m.name,w,f],g[4]=w,g[5]=m.name,g[6]=m.ownerLogin,g[7]=f,g[8]=r):r=g[8],g[9]!==w||g[10]!==_||g[11]!==f?(i=async()=>{if(f)return s.M;let e=await _?.getAuthToken();if(!e)throw Error("No token available");let t=await fetch(`https://api.githubcopilot.com/agents/sessions/resource/pull/${w}`,{headers:{Authorization:e.authorizationHeaderValue,Accept:"application/json"}});if(!t.ok)throw Error("Failed to fetch agent sessions");return(await t.json()).sessions},g[9]=w,g[10]=_,g[11]=f,g[12]=i):i=g[12],g[13]!==T||g[14]!==f?(c=e=>{if(f)return!1;let t=e.state.data;return t?t.some(h)?T:10*T:T},g[13]=T,g[14]=f,g[15]=c):c=g[15],g[16]!==p||g[17]!==r||g[18]!==i||g[19]!==c?(d={queryKey:r,queryFn:i,initialData:p,refetchInterval:c},g[16]=p,g[17]=r,g[18]=i,g[19]=c,g[20]=d):d=g[20],(0,o.I)(d)}function h(e){return e.state===i.Y.InProgress||e.state===i.Y.Idle||e.state===i.Y.WaitingForUser}},88795:(e,t,r)=>{r.d(t,{d:()=>s,t:()=>u});var n=r(74848),o=r(21728),i=r(96540);let a=i.createContext({});function s(e){let t,r=(0,o.c)(3),{repository:i,children:s}=e;return r[0]!==s||r[1]!==i?(t=(0,n.jsxs)(a.Provider,{value:i,children:[" ",s," "]}),r[0]=s,r[1]=i,r[2]=t):t=r[2],t}function u(){return i.useContext(a)}try{a.displayName||(a.displayName="CurrentRepositoryContext")}catch{}try{s.displayName||(s.displayName="CurrentRepositoryProvider")}catch{}}}]);
//# sourceMappingURL=ui_packages_agent-sessions_utils_elapsed-time-util_ts-ui_packages_agent-sessions_hooks_useSes-bd1a31-9cee01ffc48a.js.map