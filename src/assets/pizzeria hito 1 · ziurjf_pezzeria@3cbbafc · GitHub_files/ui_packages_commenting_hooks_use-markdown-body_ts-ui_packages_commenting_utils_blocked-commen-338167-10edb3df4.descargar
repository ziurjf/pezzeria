"use strict";(globalThis.webpackChunk=globalThis.webpackChunk||[]).push([["ui_packages_commenting_hooks_use-markdown-body_ts-ui_packages_commenting_utils_blocked-commen-338167"],{77283:(e,n,t)=>{t.d(n,{x:()=>y});var l=t(50363),a=t(1164),i=t(64262),r=t(10375),s=t(23812),d=t(96540),o=t(83692);let c={focusCommentComposer:"r"};var u=t(9808),m=t(67943);function y({commentBoxRef:e,markdownComposerRef:n,onChange:t,onCancel:y,referenceId:g,hasSingleKeyShortcutEnabled:p,insidePortal:h}){let[f,k]=(0,s.Fo)(u.t.localStorageKeys.issueNewComment("viewer",g),""),[x,E]=(0,d.useState)(f),C=(0,d.useMemo)(()=>(0,l.KG)(x),[x]),v=(0,i.X)(),w=void 0!==p?p:v?.current_user_settings?.use_single_key_shortcut||!1,{anyItemPickerOpen:b}=(0,a.t)(),N=(0,d.useCallback)(e=>{E(e),k(e)},[k]),j=(0,d.useCallback)(e=>{N(e),t(),""===e&&y()},[N,y,t]);(0,d.useImperativeHandle)(n,()=>({appendText:e=>{j(`${x}

${e}`)},setText:e=>{j(e)},focus:()=>{e.current?.focus()}}),[j,x,e]),(0,d.useEffect)(()=>E(x),[x,E]);let _=(0,d.useCallback)(n=>{if(!(!w||b())&&e&&e.current){n.preventDefault();let t=window.getSelection();if(t&&t.anchorNode){let e={anchorNode:t.anchorNode,range:t.getRangeAt(0)},n=t.anchorNode.parentElement,l=n?.closest((0,o.Sp)(o.mU.issueComment))??n?.closest((0,o.Sp)(o.mU.issueBody));if(l&&l instanceof HTMLDivElement){let n=(0,m.E)(l,e);N(`${n}`)}}e.current.scrollIntoView(),e.current.focus()}},[b,N,e,w]),F=(0,d.useCallback)(()=>{e.current?e.current.reset():E(""),k(void 0)},[e,k]);return(0,r._N)([c.focusCommentComposer],_,{triggerWhenInputElementHasFocus:!1,triggerWhenPortalIsActive:h}),{handleMarkdownBodyChanged:j,markdownValidationResult:C,markdownBody:x,resetMarkdownBody:F}}},55179:(e,n,t)=>{t.d(n,{i:()=>a});var l=t(39017);function a(e,n,t=null,i="issue"){return e?l.k.repoArchived:n?l.k.issueLockedToCollaborators:t||l.k.canNotComment(i)}},51062:(e,n,t)=>{t.d(n,{k:()=>l});let l={confirmations:{deleteEditHistoryTitle:"Are you sure you want to delete this revision from the history?",deleteEditHistoryContent:"This edit\u2019s content will no longer be visible. This action can not be undone.",deleteEditHistoryConfirmButtonContent:"Remove"},editHistory:{viewingEditTitle:"Viewing edit",deleted:"Deleted",mostRecent:"Most recent",emptyEdit:"This revision does not contain any content.",deletedThisRevision:"deleted this revision",created:"created",edited:"edited",deleteRevisionAriaLabel:"Delete this edit revision",ariaLabel:"Open edits",openEditsButton:"Edits",editedBy:"edited by"}}},29935:(e,n,t)=>{t.d(n,{f:()=>i});let l=function(){var e=[{defaultValue:null,kind:"LocalArgument",name:"id"}],n=[{kind:"Variable",name:"id",variableName:"id"}],t={alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},l={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null};return{fragment:{argumentDefinitions:e,kind:"Fragment",metadata:null,name:"useMarkdownEditHistoryViewerQueryQuery",selections:[{alias:null,args:n,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{kind:"InlineFragment",selections:[{args:null,kind:"FragmentSpread",name:"MarkdownEditHistoryViewer_comment"},{args:null,kind:"FragmentSpread",name:"MarkdownLastEditedBy"}],type:"Comment",abstractKey:"__isComment"}],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:e,kind:"Operation",name:"useMarkdownEditHistoryViewerQueryQuery",selections:[{alias:null,args:n,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[t,l,{kind:"InlineFragment",selections:[{alias:null,args:null,kind:"ScalarField",name:"viewerCanReadUserContentEdits",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"lastEditedAt",storageKey:null},{alias:null,args:null,concreteType:"UserContentEdit",kind:"LinkedField",name:"lastUserContentEdit",plural:!1,selections:[{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"editor",plural:!1,selections:[t,{alias:null,args:null,kind:"ScalarField",name:"url",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"login",storageKey:null},l],storageKey:null},l],storageKey:null}],type:"Comment",abstractKey:"__isComment"}],storageKey:null}]},params:{id:"d72649dd9392589f64dd4570b992b900",metadata:{},name:"useMarkdownEditHistoryViewerQueryQuery",operationKind:"query",text:null}}}();l.hash="4c6ffc38d14bcfbd11af3056fe1ca692";var a=t(18312);function i({id:e}){let n=(0,a.useLazyLoadQuery)(l,{id:e});return n.node?n.node:null}},70930:(e,n,t)=>{t.d(n,{P:()=>r});var l=t(74848),a=t(75177);let i={reason:"readonly-comment-box-module__reason--CzzUh"};function r({reason:e,icon:n,...t}){return(0,l.jsx)(a.A,{className:"blankslate",sx:{border:"1px solid",borderColor:"neutral.muted",borderRadius:2,backgroundColor:"canvas.default",boxShadow:"shadow.small"},...t,children:(0,l.jsxs)(a.A,{sx:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",color:"fg.muted"},children:[n&&(0,l.jsx)(n,{size:24}),(0,l.jsx)("div",{className:i.reason,children:e})]})})}try{r.displayName||(r.displayName="ReadonlyCommentBox")}catch{}},93715:(e,n,t)=>{t.d(n,{U:()=>d});var l=t(74848),a=t(98386),i=t(34164),r=t(78563);let s={container:"Description-module__container--b3n6F",compact:"Description-module__compact--SPRVh"};function d({children:e,style:n,className:t}){let{variant:d}=(0,r.e)();return(0,l.jsx)("div",{...(0,a.G)("list-view-item-description"),className:(0,i.$)(s.container,"compact"===d&&s.compact,t),style:n,children:e})}try{d.displayName||(d.displayName="ListItemDescription")}catch{}},81346:(e,n,t)=>{t.d(n,{Q:()=>d});var l=t(74848),a=t(98386),i=t(34164),r=t(78563);let s={container:"MainContent-module__container--ry4iL",inner:"MainContent-module__inner--bU_tk",compact:"MainContent-module__compact--mM626"};function d({children:e}){let{variant:n}=(0,r.e)();return(0,l.jsx)(l.Fragment,{children:(0,l.jsx)("div",{...(0,a.G)("list-view-item-main-content"),className:s.container,children:(0,l.jsx)("div",{className:(0,i.$)(s.inner,"compact"===n&&s.compact),children:e})})})}try{d.displayName||(d.displayName="ListItemMainContent")}catch{}},52369:(e,n,t)=>{t.d(n,{V:()=>s});var l=t(74848),a=t(98386),i=t(34164);let r={metadata:"Metadata-module__metadata--yvrod",secondary:"Metadata-module__secondary--zMgLx",primary:"Metadata-module__primary--cJgJU",alignRight:"Metadata-module__alignRight--rp0_Z"};function s({children:e,alignment:n,variant:t,...s}){return(0,l.jsx)("div",{...(0,a.G)("list-view-item-metadata-item"),...s,className:(0,i.$)(r.metadata,"primary"===t?r.primary:r.secondary,"right"===n&&r.alignRight,s.className),children:e})}try{s.displayName||(s.displayName="ListItemMetadata")}catch{}},81584:(e,n,t)=>{t.d(n,{kx:()=>w,ao:()=>v});var l,a,i=t(74848),r=t(42083),s=t(30422),d=t(98386),o=t(34164),c=t(96540),u=t(78413),m=t(78563),y=t(5989),g=t(65607),p=t(89992);let h={container:"Selection-module__container--VTcpJ",containerWithDragHandle:"Selection-module__containerWithDragHandle--xEvss",dragTrigger:"Selection-module__dragTrigger--jIZMt",compact:"Selection-module__compact--LUlY8",checkbox:"Selection-module__checkbox--nZsSH",checkboxCompact:"Selection-module__checkboxCompact--pRIwD"};var f=t(87766),k=t(14918);let x=()=>{let{variant:e}=(0,m.e)(),{isSelectable:n,hasDragHandle:t}=(0,p.v)(),{isSelected:l,onSelect:a}=(0,f.r)(),{title:r}=(0,k.J)();return n?(0,i.jsxs)("div",{className:t?h.containerWithDragHandle:h.container,...(0,d.G)("list-view-item-selection"),children:[t&&(0,i.jsx)(y.BS.DragTrigger,{className:(0,o.$)(h.dragTrigger,"compact"===e&&h.compact)}),(0,i.jsx)(g.A,{className:"default"===e?h.checkbox:h.checkboxCompact,checked:l,onChange:()=>a(!l),"aria-label":`Select: ${r}`,"data-listview-component":"selection-input",...(0,d.G)("list-view-item-selection-input")})]}):null};try{x.displayName||(x.displayName="ListItemSelection")}catch{}let E={anchor:"Title-module__anchor--SyQM6",heading:"Title-module__heading--upUxW",compact:"Title-module__compact--qLTco",container:"Title-module__container--l9xi7",trailingBadgesSpacer:"Title-module__trailingBadgesSpacer--TioiY",trailingBadgesContainer:"Title-module__trailingBadgesContainer--XGsbF",inline:"Title-module__inline--x4zR5"};function C({children:e,containerStyle:n,containerClassName:t,headerContainerRef:l,headingStyle:a,headingClassName:r,headingRef:s,leadingBadge:c,trailingBadges:y,header:g}){let{variant:p}=(0,m.e)(),{headingRef:h}=(0,k.J)(),f=(0,u.m)("listitem");return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)("div",{...(0,d.G)("list-view-item-title-container"),style:n,className:(0,o.$)(E.container,"compact"===p&&E.compact,t),ref:l,children:[(0,i.jsxs)(f,{className:(0,o.$)(E.heading,"compact"===p&&E.compact,r),style:a,ref:e=>{if(h&&(h.current=e),s&&"current"in s)try{s.current=e}catch{}},...(0,d.G)("list-view-item-title"),children:[c,g]}),y&&(0,i.jsx)("span",{className:E.trailingBadgesSpacer}),(0,i.jsx)("span",{className:E.trailingBadgesContainer,children:y}),e]}),(0,i.jsx)(x,{})]})}function v({children:e,value:n,containerStyle:t,containerClassName:l,headerContainerRef:a,headingStyle:r,headingClassName:s,headingRef:d,leadingBadge:o,trailingBadges:u,anchorRef:m,...y}){let g=(0,c.useRef)(null),p=m||g;return N({anchorRef:p,...y}),(0,i.jsx)(C,{header:y.href||y.onClick?(0,i.jsx)(b,{anchorRef:p,...y,children:(0,i.jsx)("span",{children:n})}):(0,i.jsx)("span",{children:n}),containerStyle:t,containerClassName:l,headerContainerRef:a,headingStyle:r,headingClassName:s,headingRef:d,leadingBadge:o,trailingBadges:u,children:e})}function w({children:e,html:n,containerStyle:t,containerClassName:l,headerContainerRef:a,headingStyle:r,headingClassName:d,headingRef:o,leadingBadge:c,trailingBadges:u,...m}){return N(m),(0,i.jsx)(C,{header:(0,i.jsx)(s.BC,{html:n,...m}),containerStyle:t,containerClassName:l,headerContainerRef:a,headingStyle:r,headingClassName:d,headingRef:o,leadingBadge:c,trailingBadges:u,children:e})}function b({anchorStyle:e,anchorClassName:n,anchorRef:t,linkProps:l,children:a,...r}){let{as:s="a",...u}=l??{},m=(0,c.useRef)(null);return(0,i.jsx)(s,{...(0,d.G)("listitem-title-link"),style:e,ref:t||m,className:(0,o.$)(E.anchor,E.inline,n),...r,...u,children:a})}let N=({href:e,onClick:n,anchorRef:t})=>{let{setTitleAction:l,headingRef:a}=(0,k.J)();return(0,c.useEffect)(()=>{(e||n)&&l(()=>n=>{if(e&&(n.metaKey||n.ctrlKey))window.open(e,"_blank");else if(t?.current)t.current.click();else if(a?.current){let e=a.current.querySelector("a, button");e&&e.click()}})},[t,a,e,n,l]),null};try{C.displayName||(C.displayName="InternalTitle")}catch{}try{(l=TitleTag).displayName||(l.displayName="TitleTag")}catch{}try{v.displayName||(v.displayName="ListItemTitle")}catch{}try{w.displayName||(w.displayName="ListItemSafeHTMLTitle")}catch{}try{(a=function({children:e,html:n,containerStyle:t,containerClassName:l,headerContainerRef:a,headingStyle:s,headingClassName:d,headingRef:o,leadingBadge:c,trailingBadges:u,...m}){return N(m),(0,i.jsx)(C,{header:(0,i.jsx)(r.yx,{html:n,...m}),containerStyle:t,containerClassName:l,headerContainerRef:a,headingStyle:s,headingClassName:d,headingRef:o,leadingBadge:c,trailingBadges:u,children:e})}).displayName||(a.displayName="ListItemUnsafeHTMLTitle")}catch{}try{b.displayName||(b.displayName="HeadingLink")}catch{}},19008:(e,n,t)=>{t.d(n,{W:()=>V});var l=t(74848);let a=function(){var e=[{defaultValue:null,kind:"LocalArgument",name:"id"}],n=[{kind:"Variable",name:"id",variableName:"id"}],t={alias:null,args:null,kind:"ScalarField",name:"includesCreatedEdit",storageKey:null},l=[{kind:"Literal",name:"first",value:100}],a={alias:null,args:null,kind:"ScalarField",name:"totalCount",storageKey:null},i={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},r={alias:null,args:null,kind:"ScalarField",name:"editedAt",storageKey:null},s={alias:null,args:null,kind:"ScalarField",name:"deletedAt",storageKey:null},d={alias:null,args:null,kind:"ScalarField",name:"avatarUrl",storageKey:null},o={alias:null,args:null,kind:"ScalarField",name:"login",storageKey:null},c={alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null};return{fragment:{argumentDefinitions:e,kind:"Fragment",metadata:null,name:"MarkdownEditHistoryViewerQuery",selections:[{alias:null,args:n,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{kind:"InlineFragment",selections:[t,{alias:null,args:l,concreteType:"UserContentEditConnection",kind:"LinkedField",name:"userContentEdits",plural:!1,selections:[a,{alias:null,args:null,concreteType:"UserContentEditEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:null,args:null,concreteType:"UserContentEdit",kind:"LinkedField",name:"node",plural:!1,selections:[i,r,s,{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"editor",plural:!1,selections:[d,o],storageKey:null}],storageKey:null}],storageKey:null}],storageKey:"userContentEdits(first:100)"}],type:"Comment",abstractKey:"__isComment"}],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:e,kind:"Operation",name:"MarkdownEditHistoryViewerQuery",selections:[{alias:null,args:n,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[c,{kind:"InlineFragment",selections:[t,{alias:null,args:l,concreteType:"UserContentEditConnection",kind:"LinkedField",name:"userContentEdits",plural:!1,selections:[a,{alias:null,args:null,concreteType:"UserContentEditEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:null,args:null,concreteType:"UserContentEdit",kind:"LinkedField",name:"node",plural:!1,selections:[i,r,s,{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"editor",plural:!1,selections:[c,d,o,i],storageKey:null}],storageKey:null}],storageKey:null}],storageKey:"userContentEdits(first:100)"}],type:"Comment",abstractKey:"__isComment"},i],storageKey:null}]},params:{id:"c6113eea560ba83b319c9b30fc5d4f7e",metadata:{},name:"MarkdownEditHistoryViewerQuery",operationKind:"query",text:null}}}();a.hash="58ea81646b217a25de6cfe147936e7f6";let i={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"MarkdownEditHistoryViewer_comment",selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"viewerCanReadUserContentEdits",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"lastEditedAt",storageKey:null}],type:"Comment",abstractKey:"__isComment"};i.hash="fcc1ee717c6a87a4ffdb4f4d9391d55c";var r=t(39459),s=t(6294),d=t(94232),o=t(75177),c=t(89323),u=t(15385),m=t(52464),y=t(89169),g=t(47139),p=t(96540),h=t(18312),f=t(86140);let k={couldNotDeleteEditRevision:"Failed to delete this revision",couldNotLoad:"Couldn't load"},x=({retry:e})=>(0,l.jsx)(f.h,{message:k.couldNotLoad,retry:e,sx:{p:4}});try{x.displayName||(x.displayName="CouldNotFindFallbackError")}catch{}let E=function(){var e=[{defaultValue:null,kind:"LocalArgument",name:"id"}],n=[{kind:"Variable",name:"id",variableName:"id"}],t={alias:null,args:null,kind:"ScalarField",name:"diff",storageKey:null},l={alias:null,args:null,kind:"ScalarField",name:"diffBefore",storageKey:null},a={alias:null,args:null,kind:"ScalarField",name:"deletedAt",storageKey:null},i={alias:null,args:null,kind:"ScalarField",name:"login",storageKey:null},r={alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},s={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null};return{fragment:{argumentDefinitions:e,kind:"Fragment",metadata:null,name:"EditHistoryDialogQuery",selections:[{alias:null,args:n,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{kind:"InlineFragment",selections:[t,l,a,{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"deletedBy",plural:!1,selections:[i],storageKey:null},{args:null,kind:"FragmentSpread",name:"EditHistoryDialogHeaderFragment"}],type:"UserContentEdit",abstractKey:null}],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:e,kind:"Operation",name:"EditHistoryDialogQuery",selections:[{alias:null,args:n,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[r,{kind:"InlineFragment",selections:[t,l,a,{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"deletedBy",plural:!1,selections:[r,i,s],storageKey:null},{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"editor",plural:!1,selections:[r,{alias:null,args:null,kind:"ScalarField",name:"avatarUrl",storageKey:null},i,s],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"editedAt",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"newest",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"firstEdit",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"viewerCanDelete",storageKey:null}],type:"UserContentEdit",abstractKey:null},s],storageKey:null}]},params:{id:"95112ed4d46018d629c28241b711a389",metadata:{},name:"EditHistoryDialogQuery",operationKind:"query",text:null}}}();E.hash="027faee365f58b6aa217941196bb5c80";var C=t(2724),v=t(51062);let w={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"EditHistoryDialogHeaderFragment",selections:[{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"editor",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"avatarUrl",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"login",storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"deletedAt",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"editedAt",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"newest",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"firstEdit",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"viewerCanDelete",storageKey:null}],type:"UserContentEdit",abstractKey:null};w.hash="173b0fbf2e248d6057ccd670ace2eea7";var b=t(99543),N=t(38621),j=t(53526),_=t(55847),F=t(53110);let S={deleteEditRevision:"Delete revision"},D={ghostUserLogin:"ghost"},K=function(){var e=[{defaultValue:null,kind:"LocalArgument",name:"input"}],n=[{kind:"Variable",name:"input",variableName:"input"}],t={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},l={alias:null,args:null,kind:"ScalarField",name:"deletedAt",storageKey:null},a={alias:null,args:null,kind:"ScalarField",name:"login",storageKey:null},i={alias:null,args:null,kind:"ScalarField",name:"avatarUrl",storageKey:null},r={alias:null,args:null,kind:"ScalarField",name:"diff",storageKey:null};return{fragment:{argumentDefinitions:e,kind:"Fragment",metadata:null,name:"deleteUserContentEditMutation",selections:[{alias:null,args:n,concreteType:"DeleteUserContentEditPayload",kind:"LinkedField",name:"deleteUserContentEdit",plural:!1,selections:[{alias:null,args:null,concreteType:"UserContentEdit",kind:"LinkedField",name:"userContentEdit",plural:!1,selections:[t,l,{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"deletedBy",plural:!1,selections:[a,i],storageKey:null},r],storageKey:null}],storageKey:null}],type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:e,kind:"Operation",name:"deleteUserContentEditMutation",selections:[{alias:null,args:n,concreteType:"DeleteUserContentEditPayload",kind:"LinkedField",name:"deleteUserContentEdit",plural:!1,selections:[{alias:null,args:null,concreteType:"UserContentEdit",kind:"LinkedField",name:"userContentEdit",plural:!1,selections:[t,l,{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"deletedBy",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},a,i,t],storageKey:null},r],storageKey:null}],storageKey:null}]},params:{id:"71452b9f40a7828ac05811d1ad4f821e",metadata:{},name:"deleteUserContentEditMutation",operationKind:"mutation",text:null}}}();K.hash="45e1f3e7d425560f65ef39e8c357794d";let A=({queryRef:e,userContentEditId:n})=>{let t=(0,h.useFragment)(w,e),a=(0,h.useRelayEnvironment)(),i=(0,j.S)(),{addToast:r}=(0,b.Y6)(),s=(0,p.useCallback)(async()=>{await i({title:v.k.confirmations.deleteEditHistoryTitle,content:v.k.confirmations.deleteEditHistoryContent,confirmButtonType:"danger",confirmButtonContent:v.k.confirmations.deleteEditHistoryConfirmButtonContent})&&function({environment:e,input:{id:n},onCompleted:t,onError:l}){(0,h.commitMutation)(e,{mutation:K,variables:{input:{id:n}},onCompleted:e=>{null===e.deleteUserContentEdit?l?.():t?.()},onError:e=>l?.(e)})}({environment:a,input:{id:n},onError:()=>{r({type:"error",message:k.couldNotDeleteEditRevision})}})},[r,i,a,n]),d=t.newest||t.deletedAt;return(0,l.jsxs)(o.A,{sx:{display:"flex",flexDirection:"row",position:"sticky",top:0,backgroundColor:"canvas.subtle",p:3,borderBottom:"1px solid",borderColor:"border.muted"},children:[t.editor&&(0,l.jsx)(T,{login:t.editor.login,avatarUrl:t.editor.avatarUrl,time:t.editedAt,details:t.firstEdit?v.k.editHistory.created:v.k.editHistory.edited,trailingElement:d?(0,l.jsx)(g.A,{sx:{ml:1},children:t.deletedAt?v.k.editHistory.deleted:v.k.editHistory.mostRecent}):void 0}),t.viewerCanDelete&&!t.newest&&!t.deletedAt&&(0,l.jsxs)(_.Q,{sx:{marginLeft:"auto"},variant:"danger",size:"small","aria-label":v.k.editHistory.deleteRevisionAriaLabel,onClick:s,children:[(0,l.jsx)(F.A,{icon:N.TrashIcon})," ",S.deleteEditRevision]})]})};function T({login:e,avatarUrl:n,details:t,time:a,sx:i,trailingElement:s}){let d=!!n&&!!e;return(0,l.jsxs)(o.A,{sx:{display:"flex",flexDirection:"row",gap:1,alignItems:"center"},children:[(0,l.jsxs)(o.A,{sx:{...i},children:[d&&(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(r.r,{src:n,size:16,alt:`@${e}`,sx:{boxShadow:"0 0 0 2px var(--bgColor-muted, var(--color-canvas-subtle))",mr:1}}),(0,l.jsx)(m.A,{sx:{fontWeight:"bold"},children:e})]}),!d&&(0,l.jsx)("span",{children:e??D.ghostUserLogin}),(0,l.jsxs)("span",{children:[" ",t," "]}),a&&(0,l.jsx)(y.A,{date:new Date(a)})]}),s]})}try{A.displayName||(A.displayName="EditHistoryDialogHeader")}catch{}try{T.displayName||(T.displayName="ActorOperationDetails")}catch{}var L=t(2930);let R=({userContentEditId:e,onClose:n})=>(0,l.jsx)(C.l,{renderBody:()=>(0,l.jsx)(H,{userContentEditId:e}),onClose:n,title:v.k.editHistory.viewingEditTitle,width:"xlarge",height:"auto",sx:{width:"100%",margin:4,maxWidth:"800px",maxHeight:"clamp(300px, 80vh, 800px)"}}),H=({userContentEditId:e})=>{let[n,t]=(0,h.useQueryLoader)(E);return((0,p.useEffect)(()=>{t({id:e})},[t,e]),n)?(0,l.jsx)(p.Suspense,{fallback:(0,l.jsx)(M,{}),children:(0,l.jsx)(s.A,{onRetry:()=>t({id:e},{fetchPolicy:"network-only"}),fallback:e=>(0,l.jsx)(x,{retry:e}),children:(0,l.jsx)(U,{queryRef:n,userContentEditId:e})})}):(0,l.jsx)(M,{})},U=({queryRef:e,userContentEditId:n})=>{let t=(0,h.usePreloadedQuery)(E,e).node;if(!t)return(0,l.jsx)(M,{});let a=!t.diffBefore&&!t.diff;return(0,l.jsxs)(o.A,{sx:{overflowY:"auto"},children:[(0,l.jsx)(A,{queryRef:t,userContentEditId:n}),(0,l.jsxs)(o.A,{sx:{p:3},children:[!t.deletedAt&&!a&&(0,l.jsx)(L.n,{before:t.diffBefore??void 0,after:t.diff??void 0}),!t.deletedAt&&a&&(0,l.jsx)(m.A,{sx:{color:"fg.muted",fontStyle:"italic"},children:v.k.editHistory.emptyEdit}),t.deletedAt&&(0,l.jsx)(T,{login:t.deletedBy?.login,details:v.k.editHistory.deletedThisRevision,time:t.deletedAt,sx:{color:"fg.muted",fontStyle:"italic"}})]})]})};function M(){return(0,l.jsxs)(o.A,{sx:{m:2,display:"flex",flexDirection:"column",gap:2},children:[(0,l.jsx)(d.O,{variant:"rounded",height:"md",width:"100%"}),(0,l.jsx)(d.O,{variant:"rounded",height:"md",width:"100%"})]})}try{R.displayName||(R.displayName="EditHistoryDialog")}catch{}try{H.displayName||(H.displayName="EditContent")}catch{}try{U.displayName||(U.displayName="EditContentInternal")}catch{}try{M.displayName||(M.displayName="EditContentLoading")}catch{}let B={ActionList_Description:"MarkdownEditHistoryViewer-module__ActionList_Description--Z9ggs"};function V({editHistory:e}){let n=(0,h.useFragment)(i,e),[t,a]=(0,p.useState)(!1),[r,s]=(0,p.useState)("");return n&&n.viewerCanReadUserContentEdits&&n.lastEditedAt?(0,l.jsxs)(o.A,{sx:{display:"flex"},children:[(0,l.jsxs)(c.W,{children:[(0,l.jsx)(c.W.Button,{sx:{color:"fg.muted"},variant:"invisible",size:"small","aria-label":v.k.editHistory.ariaLabel,children:v.k.editHistory.openEditsButton}),(0,l.jsx)(c.W.Overlay,{width:"auto",children:(0,l.jsx)(I,{setIsEditHistoryDialogOpen:a,setSelectedId:s,editHistoryId:n.id,lastEditedAt:n.lastEditedAt})})]}),t&&(0,l.jsx)(R,{onClose:()=>a(!1),userContentEditId:r})]}):null}let I=({editHistoryId:e,lastEditedAt:n,...t})=>{let[i,r]=(0,h.useQueryLoader)(a);return((0,p.useEffect)(()=>{r({id:e},{fetchPolicy:"network-only"})},[e,r,n]),i)?(0,l.jsx)(p.Suspense,{fallback:(0,l.jsx)(Q,{}),children:(0,l.jsx)(s.A,{onRetry:()=>r({id:e},{fetchPolicy:"network-only"}),fallback:e=>(0,l.jsx)(x,{retry:e}),children:(0,l.jsx)($,{queryRef:i,...t})})}):(0,l.jsx)(Q,{})},$=({setIsEditHistoryDialogOpen:e,setSelectedId:n,queryRef:t})=>{let i=(0,h.usePreloadedQuery)(a,t);if(!i.node?.userContentEdits)return(0,l.jsx)(Q,{});let s=i.node.userContentEdits.totalCount;return(0,l.jsx)(u.l,{sx:{maxHeight:"clamp(200px, 30vh, 320px)",overflow:"auto",width:"max-content"},children:(0,l.jsxs)(u.l.Group,{children:[(0,l.jsx)(u.l.GroupHeading,{children:`Edited ${s-1} time${s>2?"s":""}`}),i.node.userContentEdits.edges?.map((t,a)=>{let d=t?.node;if(!d?.editor)return null;let o=i.node?.includesCreatedEdit&&a===s-1;return(0,l.jsxs)(u.l.Item,{onSelect:()=>{n(d.id),e(!0)},children:[(0,l.jsx)(u.l.LeadingVisual,{children:(0,l.jsx)(r.r,{src:d.editor.avatarUrl,size:16,alt:`@${d.editor.login}`,sx:{boxShadow:"0 0 0 2px var(--bgColor-muted, var(--color-canvas-subtle))"}})}),(0,l.jsx)(m.A,{sx:{fontWeight:"normal"},children:d.editor.login}),(0,l.jsxs)(u.l.Description,{truncate:!0,className:B.ActionList_Description,children:[o&&(0,l.jsx)("div",{title:"",children:v.k.editHistory.created}),(0,l.jsx)(y.A,{date:new Date(d.editedAt)})]}),(0===a||d.deletedAt)&&(0,l.jsx)(u.l.TrailingVisual,{children:(0,l.jsx)(g.A,{children:0===a?v.k.editHistory.mostRecent:v.k.editHistory.deleted})})]},d.id)})]})})};function Q(){return(0,l.jsxs)(o.A,{sx:{m:2,display:"flex",flexDirection:"column",gap:2,minWidth:"256px"},children:[(0,l.jsx)(d.O,{variant:"rounded",height:"md",width:"100%"}),(0,l.jsx)(d.O,{variant:"rounded",height:"md",width:"100%"}),(0,l.jsx)(d.O,{variant:"rounded",height:"md",width:"100%"}),(0,l.jsx)(d.O,{variant:"rounded",height:"md",width:"100%"})]})}try{V.displayName||(V.displayName="MarkdownEditHistoryViewer")}catch{}try{I.displayName||(I.displayName="EditHistoryActionMenuContent")}catch{}try{$.displayName||($.displayName="EditHistoryActionMenuContentInternal")}catch{}try{Q.displayName||(Q.displayName="EditHistoryLoading")}catch{}},2930:(e,n,t)=>{t.d(n,{n:()=>y});var l=t(74848);let a=e=>e.split(/\r?\n/),i=e=>e.split(/\s+/),r=(e,n)=>({groups:[{words:e??"",modification:n}],modification:n}),s={diffContainer:"GroupedTextDiffViewer-module__diffContainer--hFr9Z",borderStylingAdded:"GroupedTextDiffViewer-module__borderStylingAdded--oOMUd",borderStylingRemoved:"GroupedTextDiffViewer-module__borderStylingRemoved--sC9wR",borderStylingChanged:"GroupedTextDiffViewer-module__borderStylingChanged--AAKXv",wordStylingAdded:"GroupedTextDiffViewer-module__wordStylingAdded--Vu4zN",wordStylingRemoved:"GroupedTextDiffViewer-module__wordStylingRemoved--FpdRV",diffLine:"GroupedTextDiffViewer-module__diffLine--UijDm"},d=e=>{switch(e){case"ADDED":return s.borderStylingAdded;case"REMOVED":return s.borderStylingRemoved;case"EDITED":return s.borderStylingChanged;case"UNCHANGED":return""}},o=e=>{switch(e){case"ADDED":return s.wordStylingAdded;case"REMOVED":return s.wordStylingRemoved;case"UNCHANGED":return""}},c=e=>{switch(e){case"ADDED":return{open:"[+]",close:"[/+]"};case"REMOVED":return{open:"[-]",close:"[/-]"}}return{open:"",close:""}},u=e=>"ADDED"===e||"REMOVED"===e,m=({groups:e,modification:n})=>{let t=e.map(e=>e.words).join(" ");return(0,l.jsxs)("span",{className:s.diffLine,children:["EDITED"===n&&e?.map((e,n)=>(0,l.jsxs)(l.Fragment,{children:[u(e.modification)&&(0,l.jsx)("span",{className:"sr-only",children:c(e.modification).open}),(0,l.jsx)("span",{className:o(e.modification),children:`${0===n?"":" "}${e.words}`}),u(e.modification)&&(0,l.jsx)("span",{className:"sr-only",children:c(e.modification).close})]},n-1)),"EDITED"!==n&&e.length>0&&(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("span",{className:"sr-only",children:c(n).open}),(0,l.jsx)("span",{children:t}),(0,l.jsx)("span",{className:"sr-only",children:c(n).close})]}),0===e.length&&(0,l.jsx)("br",{})]})},y=({before:e,after:n})=>{let t=function({before:e,after:n}){let t=e?a(e):[],l=n?a(n):[],s=[];for(let e=0;e<t.length||e<l.length;e++){let n=t[e],a=l[e];s.push(function(e,n){let t=e?i(e):[],l=n?i(n):[];if(0===t.length&&0===l.length||e===n)return r(e,"UNCHANGED");if(0===t.length)return r(n,"ADDED");if(0===l.length)return r(e,"REMOVED");let a=[],s={words:"",modification:"UNCHANGED"},d={words:"",modification:"ADDED"},o={words:"",modification:"REMOVED"};for(let e=0;e<t.length||e<l.length;e++){let n=t[e],i=l[e];n===i?(s.words=`${s.words}${0===s.words.length?"":" "}${n}`,""!==d.words&&(a.push(d),d={words:"",modification:"ADDED"}),""!==o.words&&(a.push(o),o={words:"",modification:"REMOVED"})):(""!==s.words&&(void 0!==n||void 0!==i)&&(a.push(s),s={words:"",modification:"UNCHANGED"}),void 0!==n&&(o.words=`${o.words}${0===o.words.length?"":" "}${n}`),void 0!==i&&(d.words=`${d.words}${0===d.words.length?"":" "}${i}`))}return""!==d.words&&a.push(d),""!==o.words&&a.push(o),""!==s.words&&a.push(s),{groups:a,modification:"EDITED"}}(n,a))}return{lines:s}}({before:e,after:n});return(0,l.jsx)("div",{className:s.diffContainer,children:t.lines.map((e,n)=>(0,l.jsx)("div",{className:d(e.modification),children:(0,l.jsx)(m,{...e})},n))})};try{m.displayName||(m.displayName="LineDiffViewer")}catch{}try{y.displayName||(y.displayName="GroupedTextDiffViewer")}catch{}},66499:(e,n,t)=>{t.d(n,{_:()=>o});var l=t(74848);let a={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"MarkdownLastEditedBy",selections:[{alias:null,args:null,kind:"ScalarField",name:"viewerCanReadUserContentEdits",storageKey:null},{alias:null,args:null,concreteType:"UserContentEdit",kind:"LinkedField",name:"lastUserContentEdit",plural:!1,selections:[{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"editor",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"url",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"login",storageKey:null}],storageKey:null}],storageKey:null}],type:"Comment",abstractKey:"__isComment"};a.hash="bbab0cb2d43eeaaa0ed5b010868ec7f4";var i=t(34614),r=t(18312),s=t(51062);let d={container:"MarkdownLastEditedBy-module__container--fKxHN"};function o({editInformation:e,includeSeparator:n,forceUnderline:t}){let o=(0,r.useFragment)(a,e);if(!o||!o.viewerCanReadUserContentEdits||!o.lastUserContentEdit||!o.lastUserContentEdit.editor)return null;let{login:c,url:u}=o.lastUserContentEdit.editor;return(0,l.jsxs)("span",{className:d.container,children:[n&&(0,l.jsx)("span",{children:" \xb7 "}),(0,l.jsxs)("span",{children:[`${s.k.editHistory.editedBy} `,(0,l.jsx)(i.A,{sx:{color:"fg.muted"},href:u,inline:t,children:c})]})]})}try{o.displayName||(o.displayName="MarkdownLastEditedBy")}catch{}},6294:(e,n,t)=>{t.d(n,{A:()=>o});var l=t(74848),a=t(96540),i=t(22353),r=t(78924);function s(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}let d=e=>(0,l.jsxs)("div",{children:[(0,l.jsx)("span",{children:"Error:"}),(0,l.jsx)("button",{onClick:e,children:"Retry"})]});let BasicPreloadedQueryBoundary=class BasicPreloadedQueryBoundary extends a.Component{static getDerivedStateFromError(e){return{error:e}}componentDidCatch(e){let n=e.shouldSkipReport??!1,t={critical:this.props.critical||!1,reactAppName:this.props.appName};n||(0,i.N7)(e,t)}render(){let{children:e}=this.props,{error:n}=this.state,t=this.props.fallback||d;return n?t(this._retry,n):e}constructor(...e){super(...e),s(this,"state",{error:null}),s(this,"_retry",()=>{this.props.onRetry(),this.setState({error:null})})}};function o(e){let n=(0,a.useContext)(r.I),t=e.appName||n?.appName;return(0,l.jsx)(BasicPreloadedQueryBoundary,{...e,appName:t})}try{o.displayName||(o.displayName="PreloadedQueryBoundary")}catch{}}}]);
//# sourceMappingURL=ui_packages_commenting_hooks_use-markdown-body_ts-ui_packages_commenting_utils_blocked-commen-338167-be24ffafb47d.js.map